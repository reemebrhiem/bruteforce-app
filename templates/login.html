<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>تسجيل الدخول</title>

<style>
body {
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    font-family:Arial;
    background:#f5f5f5;
}
.box {
    width:320px;
    background:white;
    padding:20px;
    border-radius:8px;
    text-align:center;
}
input, button {
    width:100%;
    padding:10px;
    margin:6px 0;
}
#msg { color:red; }
</style>
</head>

<body>
<div class="box">
<h2>تسجيل الدخول</h2>

<form onsubmit="login(); return false;">
    <input id="username" placeholder="اسم المستخدم">
    <input id="password" type="password" placeholder="كلمة المرور">
    <button type="submit">دخول</button>
</form>

<button onclick="location.href='/register'">إنشاء حساب</button>
<div id="msg"></div>
</div>

<script>
function login(){
    const username=document.getElementById("username").value;
    const password=document.getElementById("password").value;
    const msg=document.getElementById("msg");

    fetch("/login",{
        method:"POST",
        headers:{"Content-Type":"application/x-www-form-urlencoded"},
        body:"username="+username+"&password="+password
    })
    .then(res=>{
        if(res.status===200) return "SUCCESS";
        if(res.status===404) return "NO_USER";
        if(res.status===401) return "WRONG_PASSWORD";
        if(res.status===403) return "ATTACK";
    })
    .then(result=>{
        if(result==="SUCCESS"){
            location.href="/dashboard/"+username;
        } else if(result==="NO_USER"){
            msg.innerText="الحساب غير موجود";
        } else if(result==="WRONG_PASSWORD"){
            msg.innerText="كلمة المرور غير صحيحة";
        } else {
            msg.innerText="تم اكتشاف هجوم قوة غاشمة";
        }
    });
}
</script>
</body>
</html>
