<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>إنشاء حساب</title>
</head>
<body style="text-align:center;margin-top:100px">

<h2>إنشاء حساب</h2>

<input id="username" placeholder="اسم المستخدم"><br><br>
<input id="password" type="password" placeholder="كلمة المرور"><br><br>

<button onclick="register()">تسجيل</button>
<p id="msg"></p>

<script>
function register(){
    const msg = document.getElementById("msg");

    fetch("/register",{
        method:"POST",
        headers:{"Content-Type":"application/x-www-form-urlencoded"},
        body:"username="+username.value+"&password="+password.value
    })
    .then(res => res.text().then(t => ({status:res.status,text:t})))
    .then(r=>{
        if(r.status===201){
            msg.style.color="green";
            msg.innerText="تم إنشاء الحساب بنجاح";
            setTimeout(()=>location.href="/",1500);
        }else if(r.status===409){
            msg.innerText="اسم المستخدم موجود مسبقًا";
        }else if(r.text.startsWith("BLOCKED")){
            msg.innerText="محظور مؤقتًا، حاول لاحقًا";
        }else{
            msg.innerText="حدث خطأ";
        }
    })
}
</script>
</body>
</html>
